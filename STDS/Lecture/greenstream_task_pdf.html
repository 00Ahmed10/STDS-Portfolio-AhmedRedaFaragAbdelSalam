<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenStream Energy - Design Thinking Task Solution</title>
    <style>
        @page {
            margin: 2cm;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 210mm;
            margin: 0 auto;
            padding: 20px;
            background: white;
        }
        
        h1 {
            color: #2c5f2d;
            border-bottom: 3px solid #2c5f2d;
            padding-bottom: 10px;
            margin-top: 0;
            font-size: 2em;
        }
        
        h2 {
            color: #2c5f2d;
            margin-top: 30px;
            border-left: 4px solid #2c5f2d;
            padding-left: 15px;
            page-break-after: avoid;
        }
        
        h3 {
            color: #4a7c4e;
            margin-top: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            background: linear-gradient(135deg, #2c5f2d 0%, #4a7c4e 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
        }
        
        .header h1 {
            color: white;
            border: none;
            margin: 0;
        }
        
        .subtitle {
            font-size: 1.1em;
            margin-top: 10px;
            opacity: 0.9;
        }
        
        .section {
            margin-bottom: 30px;
            page-break-inside: avoid;
        }
        
        .diagram-container {
            background: #f9f9f9;
            border: 2px solid #2c5f2d;
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
        }
        
        .etl-diagram {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .flow-box {
            background: white;
            border: 2px solid #2c5f2d;
            border-radius: 8px;
            padding: 15px;
            margin: 10px;
            display: inline-block;
            min-width: 150px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .flow-box.source {
            background: #e3f2fd;
            border-color: #1976d2;
        }
        
        .flow-box.transform {
            background: #fff3e0;
            border-color: #f57c00;
        }
        
        .flow-box.destination {
            background: #e8f5e9;
            border-color: #388e3c;
        }
        
        .flow-box.error {
            background: #ffebee;
            border-color: #d32f2f;
        }
        
        .arrow {
            display: inline-block;
            margin: 10px;
            font-size: 24px;
            color: #2c5f2d;
        }
        
        .rule-card {
            background: white;
            border-left: 4px solid #2c5f2d;
            padding: 15px;
            margin: 15px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            page-break-inside: avoid;
        }
        
        .rule-title {
            color: #2c5f2d;
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 8px;
        }
        
        .lifecycle-step {
            background: #f0f7f0;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            border-left: 5px solid #2c5f2d;
            page-break-inside: avoid;
        }
        
        .step-number {
            background: #2c5f2d;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .highlight-box {
            background: #fff9c4;
            border: 2px solid #f9a825;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        th {
            background: #2c5f2d;
            color: white;
        }
        
        tr:nth-child(even) {
            background: #f9f9f9;
        }
        
        .icon {
            font-size: 20px;
            margin-right: 8px;
        }
        
        @media print {
            body {
                padding: 0;
            }
            .section {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>‚ö° GreenStream Energy</h1>
        <p class="subtitle">Design Thinking for Data Scientists</p>
        <p class="subtitle">Serverless ETL Pipeline Design Solution</p>
    </div>

    <div class="section">
        <h2>üìã Case Study Overview</h2>
        <p>
            <strong>Company:</strong> GreenStream Energy<br>
            <strong>Scope:</strong> 50,000 households with smart meters<br>
            <strong>Challenge:</strong> Dark data not transformed into actionable insights
        </p>
        
        <h3>Strategic Goals:</h3>
        <ul>
            <li>Identify peak energy consumption periods</li>
            <li>Detect abnormal or faulty smart meters</li>
            <li>Prepare data for predictive analytics and forecasting</li>
        </ul>
    </div>

    <div class="section" style="page-break-before: always;">
        <h2>üìä Task A: ETL Architecture Diagram</h2>
        
        <div class="diagram-container">
            <svg class="etl-diagram" viewBox="0 0 800 900" xmlns="http://www.w3.org/2000/svg">
                <!-- Source Layer -->
                <rect x="300" y="20" width="200" height="60" fill="#e3f2fd" stroke="#1976d2" stroke-width="3" rx="8"/>
                <text x="400" y="45" text-anchor="middle" font-size="14" font-weight="bold" fill="#1976d2">üìÅ RAW DATA SOURCE</text>
                <text x="400" y="65" text-anchor="middle" font-size="12" fill="#333">CSV Files (Smart Meters)</text>
                
                <!-- Arrow to Trigger -->
                <path d="M 400 80 L 400 120" stroke="#2c5f2d" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
                <text x="420" y="105" font-size="11" fill="#666">Upload Event</text>
                
                <!-- Trigger/Orchestration -->
                <rect x="300" y="120" width="200" height="50" fill="#fff3e0" stroke="#f57c00" stroke-width="3" rx="8"/>
                <text x="400" y="145" text-anchor="middle" font-size="14" font-weight="bold" fill="#f57c00">‚öôÔ∏è EVENT TRIGGER</text>
                <text x="400" y="162" text-anchor="middle" font-size="11" fill="#333">Serverless Function</text>
                
                <!-- Arrow to Transform -->
                <path d="M 400 170 L 400 210" stroke="#2c5f2d" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
                
                <!-- Transform Layer -->
                <rect x="250" y="210" width="300" height="120" fill="#fff3e0" stroke="#f57c00" stroke-width="3" rx="8"/>
                <text x="400" y="235" text-anchor="middle" font-size="16" font-weight="bold" fill="#f57c00">üîÑ TRANSFORMATION LAYER</text>
                
                <!-- Transform steps -->
                <text x="270" y="260" font-size="12" fill="#333">‚úì Unit Standardization (W ‚Üí kW)</text>
                <text x="270" y="280" font-size="12" fill="#333">‚úì Missing Value Handling</text>
                <text x="270" y="300" font-size="12" fill="#333">‚úì Data Validation</text>
                <text x="270" y="320" font-size="12" fill="#333">‚úì Faulty Meter Detection</text>
                
                <!-- Success Path -->
                <path d="M 400 330 L 400 370" stroke="#388e3c" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
                <text x="420" y="355" font-size="11" fill="#388e3c" font-weight="bold">SUCCESS</text>
                
                <!-- Structured Storage (RDS) -->
                <rect x="300" y="370" width="200" height="60" fill="#e8f5e9" stroke="#388e3c" stroke-width="3" rx="8"/>
                <text x="400" y="395" text-anchor="middle" font-size="14" font-weight="bold" fill="#388e3c">üíæ STRUCTURED DB</text>
                <text x="400" y="415" text-anchor="middle" font-size="12" fill="#333">RDS (PostgreSQL/MySQL)</text>
                
                <!-- Arrow to Archive -->
                <path d="M 400 430 L 400 470" stroke="#2c5f2d" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
                <text x="420" y="455" font-size="11" fill="#666">Convert & Archive</text>
                
                <!-- Archive Storage -->
                <rect x="300" y="470" width="200" height="60" fill="#e8f5e9" stroke="#388e3c" stroke-width="3" rx="8"/>
                <text x="400" y="495" text-anchor="middle" font-size="14" font-weight="bold" fill="#388e3c">üì¶ ANALYTICS ARCHIVE</text>
                <text x="400" y="515" text-anchor="middle" font-size="12" fill="#333">Parquet Format (Data Lake)</text>
                
                <!-- Failure Path -->
                <path d="M 250 270 L 120 270 L 120 580" stroke="#d32f2f" stroke-width="3" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
                <text x="140" y="265" font-size="11" fill="#d32f2f" font-weight="bold">FAILURE</text>
                
                <!-- Error Handler -->
                <rect x="20" y="580" width="200" height="60" fill="#ffebee" stroke="#d32f2f" stroke-width="3" rx="8"/>
                <text x="120" y="605" text-anchor="middle" font-size="14" font-weight="bold" fill="#d32f2f">‚ö†Ô∏è ERROR HANDLER</text>
                <text x="120" y="625" text-anchor="middle" font-size="12" fill="#333">Log & Retry Queue</text>
                
                <!-- Retry Path -->
                <path d="M 220 610 L 680 610 L 680 270 L 550 270" stroke="#ff9800" stroke-width="3" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
                <text x="690" y="440" font-size="11" fill="#ff9800" font-weight="bold">RETRY</text>
                <text x="690" y="455" font-size="10" fill="#666">(Max 3 attempts)</text>
                
                <!-- Dead Letter Queue -->
                <path d="M 120 640 L 120 720" stroke="#d32f2f" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
                <text x="140" y="685" font-size="11" fill="#d32f2f">Max Retries</text>
                
                <rect x="20" y="720" width="200" height="60" fill="#ffebee" stroke="#d32f2f" stroke-width="3" rx="8"/>
                <text x="120" y="745" text-anchor="middle" font-size="14" font-weight="bold" fill="#d32f2f">‚ò†Ô∏è DEAD LETTER QUEUE</text>
                <text x="120" y="765" text-anchor="middle" font-size="12" fill="#333">Manual Investigation</text>
                
                <!-- Monitoring -->
                <rect x="550" y="370" width="200" height="160" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2" rx="8" stroke-dasharray="5,5"/>
                <text x="650" y="395" text-anchor="middle" font-size="14" font-weight="bold" fill="#7b1fa2">üìà MONITORING</text>
                <text x="570" y="420" font-size="11" fill="#333">‚Ä¢ Success/Failure Rates</text>
                <text x="570" y="440" font-size="11" fill="#333">‚Ä¢ Processing Time</text>
                <text x="570" y="460" font-size="11" fill="#333">‚Ä¢ Data Quality Metrics</text>
                <text x="570" y="480" font-size="11" fill="#333">‚Ä¢ Faulty Meter Alerts</text>
                <text x="570" y="500" font-size="11" fill="#333">‚Ä¢ Cost Tracking</text>
                
                <!-- Arrow markers -->
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#2c5f2d"/>
                    </marker>
                </defs>
            </svg>
        </div>
        
        <h3>Architecture Components Explanation:</h3>
        <table>
            <tr>
                <th>Component</th>
                <th>Purpose</th>
                <th>Technology Pattern</th>
            </tr>
            <tr>
                <td><strong>Raw Data Source</strong></td>
                <td>Initial upload point for CSV files</td>
                <td>Object Storage (e.g., S3, Blob Storage)</td>
            </tr>
            <tr>
                <td><strong>Event Trigger</strong></td>
                <td>Automatically initiates processing on upload</td>
                <td>Event-driven serverless function</td>
            </tr>
            <tr>
                <td><strong>Transformation Layer</strong></td>
                <td>Applies business rules and data cleaning</td>
                <td>Serverless compute (Lambda, Cloud Functions)</td>
            </tr>
            <tr>
                <td><strong>Structured DB (RDS)</strong></td>
                <td>Queryable storage for validation and analysis</td>
                <td>Relational Database</td>
            </tr>
            <tr>
                <td><strong>Analytics Archive</strong></td>
                <td>Optimized long-term storage in Parquet</td>
                <td>Data Lake</td>
            </tr>
            <tr>
                <td><strong>Error Handler</strong></td>
                <td>Manages failed records with retry logic</td>
                <td>Message Queue with DLQ</td>
            </tr>
            <tr>
                <td><strong>Monitoring</strong></td>
                <td>Tracks pipeline health and data quality</td>
                <td>Logging and metrics service</td>
            </tr>
        </table>
    </div>

    <div class="section" style="page-break-before: always;">
        <h2>üìù Task B: Transformation Logic & Business Rules</h2>
        
        <div class="rule-card">
            <div class="rule-title">Rule 1: Unit Standardization</div>
            <p><strong>Condition:</strong> If energy_unit = "W" (Watts)</p>
            <p><strong>Action:</strong> value_kw = value_w / 1000; unit = "kW"</p>
            <p><strong>Rationale:</strong> Standardizes all measurements to kilowatts (kW) for consistent analysis and eliminates unit-related calculation errors in downstream analytics.</p>
            <p><strong>Example:</strong> 2500 W ‚Üí 2.5 kW</p>
        </div>
        
        <div class="rule-card">
            <div class="rule-title">Rule 2: Missing Value Handling</div>
            <p><strong>Condition:</strong> If energy_reading IS NULL or empty</p>
            <p><strong>Action:</strong> 
                <br>‚Ä¢ Flag record with status = "MISSING_DATA"
                <br>‚Ä¢ Add to missing_readings_log table
                <br>‚Ä¢ Exclude from peak-usage and consumption calculations
                <br>‚Ä¢ Keep record for completeness audit
            </p>
            <p><strong>Rationale:</strong> Prevents NULL values from distorting analytics while maintaining data lineage for troubleshooting and meter health analysis.</p>
        </div>
        
        <div class="rule-card">
            <div class="rule-title">Rule 3: Negative Value Validation</div>
            <p><strong>Condition:</strong> If energy_reading < 0</p>
            <p><strong>Action:</strong> 
                <br>‚Ä¢ Flag as "INVALID_NEGATIVE"
                <br>‚Ä¢ Exclude from all calculations
                <br>‚Ä¢ Alert for meter calibration issue
            </p>
            <p><strong>Rationale:</strong> Negative energy consumption is physically impossible and indicates meter malfunction or data corruption.</p>
        </div>
        
        <div class="rule-card">
            <div class="rule-title">Rule 4: Extreme Value Detection</div>
            <p><strong>Condition:</strong> If energy_reading > 20 kW for residential meter</p>
            <p><strong>Action:</strong> 
                <br>‚Ä¢ Flag as "ANOMALY_HIGH"
                <br>‚Ä¢ Include in analysis with warning flag
                <br>‚Ä¢ Trigger investigation workflow
            </p>
            <p><strong>Rationale:</strong> Residential households typically consume 0.5-3 kW average. Readings above 20 kW may indicate data errors, meter tampering, or unusual circumstances requiring verification.</p>
        </div>
        
        <div class="rule-card">
            <div class="rule-title">Rule 5: Faulty Meter Detection - Zero Consumption</div>
            <p><strong>Condition:</strong> If meter reports 0 kW for 24+ consecutive hours</p>
            <p><strong>Action:</strong> 
                <br>‚Ä¢ Flag meter_id as "POTENTIALLY_FAULTY"
                <br>‚Ä¢ Add to faulty_meters table
                <br>‚Ä¢ Generate maintenance ticket
                <br>‚Ä¢ Exclude meter's data from consumption aggregates
            </p>
            <p><strong>Rationale:</strong> Even unoccupied homes have baseline consumption (refrigerators, standby power). 24+ hours of zero consumption indicates disconnection or malfunction.</p>
        </div>
        
        <div class="rule-card">
            <div class="rule-title">Rule 6: Faulty Meter Detection - Unchanging Values</div>
            <p><strong>Condition:</strong> If meter reports identical reading for 12+ consecutive readings</p>
            <p><strong>Action:</strong> 
                <br>‚Ä¢ Flag as "STUCK_METER"
                <br>‚Ä¢ Mark for technical inspection
            </p>
            <p><strong>Rationale:</strong> Real consumption varies naturally. Identical consecutive values suggest the meter has stopped updating.</p>
        </div>
        
        <div class="rule-card">
            <div class="rule-title">Rule 7: Timestamp Validation</div>
            <p><strong>Condition:</strong> If timestamp is in the future OR older than 30 days</p>
            <p><strong>Action:</strong> 
                <br>‚Ä¢ Flag as "INVALID_TIMESTAMP"
                <br>‚Ä¢ Attempt correction using server time
                <br>‚Ä¢ Log discrepancy for clock sync investigation
            </p>
            <p><strong>Rationale:</strong> Ensures data temporal integrity and identifies clock synchronization issues with smart meters.</p>
        </div>
        
        <div class="rule-card">
            <div class="rule-title">Rule 8: Duplicate Record Prevention</div>
            <p><strong>Condition:</strong> If record with same (meter_id + timestamp) already exists</p>
            <p><strong>Action:</strong> 
                <br>‚Ä¢ Skip insertion (idempotency)
                <br>‚Ä¢ Log duplicate attempt
                <br>‚Ä¢ Keep only first occurrence
            </p>
            <p><strong>Rationale:</strong> Prevents double-counting in analytics due to retry logic or transmission errors.</p>
        </div>
        
        <div class="highlight-box">
            <strong>üìä Data Quality Score Calculation:</strong><br>
            After applying all rules, each record receives a quality_score:
            <ul>
                <li><strong>100%:</strong> Passes all validations</li>
                <li><strong>75%:</strong> Minor issues (e.g., unit conversion needed)</li>
                <li><strong>50%:</strong> Moderate issues (e.g., anomaly detected but plausible)</li>
                <li><strong>0%:</strong> Critical issues (NULL values, invalid timestamps, negative readings)</li>
            </ul>
            Only records with quality_score ‚â• 50% are used in peak consumption analysis.
        </div>
    </div>

    <div class="section" style="page-break-before: always;">
        <h2>üîÑ Task C: Single Record Lifecycle</h2>
        <p><strong>Scenario:</strong> Tracking one smart meter reading from Household ID: H-42857</p>
        
        <div class="lifecycle-step">
            <div><span class="step-number">1</span><strong>Upload to Raw Storage</strong></div>
            <p><strong>What happens:</strong></p>
            <ul>
                <li>At 14:30:00, meter H-42857 sends a reading via WiFi</li>
                <li>CSV file named <code>meter_H42857_20241218_143000.csv</code> is uploaded to raw data storage</li>
                <li>File contains: <code>meter_id,timestamp,energy_value,unit</code></li>
                <li>Example record: <code>H-42857,2024-12-18 14:30:00,2500,W</code></li>
            </ul>
            <p><strong>Storage location:</strong> <code>/raw-data/2024/12/18/meter_H42857_20241218_143000.csv</code></p>
        </div>
        
        <div class="lifecycle-step">
            <div><span class="step-number">2</span><strong>Triggering of Transformation Process</strong></div>
            <p><strong>What happens:</strong></p>
            <ul>
                <li>Object storage detects new file upload</li>
                <li>Creates an event notification with file metadata</li>
                <li>Event triggers serverless function (e.g., Lambda function)</li>
                <li>Function receives: <code>{ bucket: 'raw-data', key: 'meter_H42857_20241218_143000.csv' }</code></li>
                <li>Function initiates within 100-500ms of upload</li>
            </ul>
            <p><strong>Trigger type:</strong> Event-driven (automatic, no manual intervention)</p>
        </div>
        
        <div class="lifecycle-step">
            <div><span class="step-number">3</span><strong>Data Cleaning and Validation Steps</strong></div>
            <p><strong>Transformation sequence for record H-42857:</strong></p>
            
            <p><strong>Step 3.1 - Parse CSV:</strong></p>
            <ul>
                <li>Read file from raw storage</li>
                <li>Parse CSV into structured object</li>
                <li>Extract: meter_id="H-42857", timestamp="2024-12-18 14:30:00", value=2500, unit="W"</li>
            </ul>
            
            <p><strong>Step 3.2 - Apply Business Rules:</strong></p>
            <ul>
                <li><strong>Rule 1 (Unit Standardization):</strong> Unit is "W" ‚Üí Convert: 2500 / 1000 = 2.5 kW ‚úì</li>
                <li><strong>Rule 2 (Missing Value):</strong> Value exists ‚Üí Pass ‚úì</li>
                <li><strong>Rule 3 (Negative Check):</strong> 2.5 > 0 ‚Üí Pass ‚úì</li>
                <li><strong>Rule 4 (Extreme Value):</strong> 2.5 < 20 ‚Üí Pass ‚úì</li>
                <li><strong>Rule 7 (Timestamp):</strong> Timestamp valid and recent ‚Üí Pass ‚úì</li>
            </ul>
            
            <p><strong>Step 3.3 - Check Historical Pattern:</strong></p>
            <ul>
                <li>Query last 24 readings for meter H-42857</li>
                <li>Previous reading: 2.3 kW (1 hour ago)</li>
                <li>Pattern check: Not zero, not stuck ‚Üí Pass ‚úì</li>
            </ul>
            
            <p><strong>Step 3.4 - Enrich Data:</strong></p>
            <ul>
                <li>Add processing_timestamp: "2024-12-18 14:30:02"</li>
                <li>Add quality_score: 100 (all validations passed)</li>
                <li>Add record_status: "VALID"</li>
                <li>Calculate: day_of_week="Thursday", hour=14 (for peak analysis)</li>
            </ul>
            
            <p><strong>Transformed record:</strong></p>
            <pre style="background: #f5f5f5; padding: 10px; border-radius: 4px; font-size: 11px;">
{
  "meter_id": "H-42857",
  "timestamp": "2024-12-18T14:30:00Z",
  "energy_kw": 2.5,
  "unit": "kW",
  "quality_score": 100,
  "status": "VALID",
  "processing_timestamp": "2024-12-18T14:30:02Z",
  "day_of_week": "Thursday",
  "hour": 14
}
            </pre>
        </div>
        
        <div class="lifecycle-step">
            <div><span class="step-number">4</span><strong>Storage in Structured Format (RDS)</strong></div>
            <p><strong>What happens:</strong></p>
            <ul>
                <li>Open database connection to PostgreSQL RDS</li>
                <li>Execute INSERT query into <code>energy_readings</code> table</li>
                <li>SQL: <code>INSERT INTO energy_readings (meter_id, timestamp, energy_kw, quality_score, status) VALUES ('H-42857', '2024-12-18 14:30:00', 2.5, 100, 'VALID')</code></li>
                <li>Transaction committed successfully</li>
                <li>Record now available for real-time queries and dashboards</li>
            </ul>
            <p><strong>Why RDS:</strong> Enables immediate SQL queries like "Show current consumption for all meters" or "Alert if consumption exceeds threshold"</p>
        </div>
        
        <div class="lifecycle-step">
            <div><span class="step-number">5</span><strong>Conversion and Archival in Parquet Format</strong></div>
            <p><strong>What happens:</strong></p>
            <ul>
                <li>Record added to in-memory batch buffer</li>
                <li>When buffer reaches 1000 records OR 5 minutes elapsed:</li>
                <li>Convert batch to columnar Parquet format</li>
                <li>Apply compression (Snappy algorithm)</li>
                <li>Partition by date: <code>/analytics-lake/year=2024/month=12/day=18/data.parquet</code></li>
                <li>Write to data lake storage</li>
            </ul>
            <p><strong>Why Parquet:</strong></p>
            <ul>
                <li>Columnar format: 80% storage reduction vs CSV</li>
                <li>Optimized for analytics: Fast aggregations (e.g., "Average consumption per hour")</li>
                <li>Schema preservation: Maintains data types</li>
                <li>Partitioning: Enables efficient time-range queries</li>
            </ul>
        </div>
        
        <div class="lifecycle-step">
            <div><span class="step-number">6</span><strong>Success and Failure Handling</strong></div>
            
            <p><strong>SUCCESS PATH (for our H-42857 record):</strong></p>
            <ul>
                <li>‚úì All steps completed successfully</li>
                <li>‚úì Record exists in both RDS and data lake</li>
                <li>‚úì Log entry: <code>{"level":"INFO", "message":"Record processed", "meter_id":"H-42857", "duration_ms":156}</code></li>
                <li>‚úì Monitoring dashboard incremented success counter</li>
                <li>‚úì Original CSV file moved to <code>/processed/2024/12/18/</code> folder</li>
            </ul>
            
            <p><strong>FAILURE SCENARIOS (if something went wrong):</strong></p>
            
            <p><strong>Scenario A - Database Connection Failure:</strong></p>
            <ul>
                <li>RDS is temporarily unavailable (network issue)</li>
                <li>Function catches exception: <code>DatabaseConnectionError</code></li>
                <li>Record placed in retry queue with metadata</li>
                <li>Retry attempt #1 after 30 seconds ‚Üí Success</li>
                <li>Record processed normally (eventual consistency)</li>
            </ul>
            
            <p><strong>Scenario B - Data Validation Failure:</strong></p>
            <ul>
                <li>Record has NULL energy value: <code>H-42857,2024-12-18 14:30:00,NULL,W</code></li>
                <li>Rule 2 triggers: Missing value detected</li>
                <li>Status set to "MISSING_DATA"</li>
                <li>Stored in separate <code>invalid_readings</code> table</li>
                <li>Alert sent to operations team</li>
                <li>No retry (data issue, not system issue)</li>
            </ul>
            
            <p><strong>Scenario C - Maximum Retries Exceeded:</strong></p>
            <ul>
                <li>After 3 retry attempts, still failing (e.g., corrupted CSV format)</li>
                <li>Record moved to Dead Letter Queue (DLQ)</li>
                <li>Alert triggered for manual investigation</li>
                <li>Original file preserved in <code>/failed/</code> folder</li>
                <li>Operations team reviews and fixes data/code issue</li>
                <li>Can manually re-trigger processing after fix</li>
            </ul>
            
            <p><strong>Error Handling Strategy:</strong></p>
            <table>
                <tr>
                    <th>Error Type</th>
                    <th>Retry?</th>
                    <th>Action</th>
                </tr>
                <tr>
                    <td>Network timeout</td>
                    <td>Yes (3x)</td>
                    <td>Exponential backoff: 30s, 60s, 120s</td>
                </tr>
                <tr>
                    <td>Database connection</td>
                    <td>Yes (3x)</td>
                    <td>Retry with backoff</td>
                </tr>
                <tr>
                    <td>Data validation failure</td>
                    <td>No</td>
                    <td>Log to invalid_readings table</td>
                </tr>
                <tr>
                    <td>Corrupted file format</td>
                    <td>No</td>
                    <td>Send to DLQ for manual review</td>
                </tr>
                <tr>
                    <td>Duplicate record</td>
                    <td>No</td>
                    <td>Skip insertion (idempotent)</td>
                </tr>
            </table>
        </div>
        
        <div class="highlight-box">
            <strong>‚è±Ô∏è Complete Lifecycle Timeline for Record H-42857:</strong>
            <ul>
                <li><strong>T+0ms:</strong> File uploaded to raw storage</li>
                <li><strong>T+150ms:</strong> Serverless function triggered</li>
                <li><strong>T+200ms:</strong> CSV parsed and validations begin</li>
                <li><strong>T+450ms:</strong> All business rules applied successfully</li>
                <li><strong>T+600ms:</strong> Inserted into RDS</li>
                <li><strong>T+5min:</strong> Batched and written to Parquet in data lake</li>
                <li><strong>T+5min:</strong> Original CSV moved to processed folder</li>
            </ul>
            <p><strong>Total processing time: ~600ms for RDS, ~5min for archive</strong></p>
        </div>
    </div>

    <div class="section" style="page-break-before: always;">
        <h2>üéØ Summary: Design Thinking Principles Applied</h2>
        
        <h3>Data Science Thinking Demonstrated:</h3>
        
        <div class="rule-card">
            <div class="rule-title">1. Empathy for Data Quality</div>
            <p>Understanding real-world data issues (inconsistent units, missing values, faulty meters) and designing rules that handle them gracefully rather than assuming perfect data.</p>
        </div>
        
        <div class="rule-card">
            <div class="rule-title">2. Iterative Problem-Solving</div>
            <p>The pipeline doesn't just fail on errors‚Äîit attempts retries with exponential backoff, logs issues for investigation, and routes unrecoverable errors to human review.</p>
        </div>
        
        <div class="rule-card">
            <div class="rule-title">3. Scalability Considerations</div>
            <p>Serverless architecture scales automatically with 50,000 households. Batch processing for Parquet conversion balances real-time needs with efficient resource usage.</p>
        </div>
        
        <div class="rule-card">
            <div class="rule-title">4. Business Value Focus</div>
            <p>Design directly supports strategic goals: peak consumption analysis (RDS for queries), faulty meter detection (validation rules), and predictive analytics (Parquet for ML models).</p>
        </div>
        
        <div class="rule-card">
            <div class="rule-title">5. Observability and Continuous Improvement</div>
            <p>Monitoring layer tracks data quality scores, processing times, and error rates‚Äîenabling data-driven optimization of the pipeline itself.</p>
        </div>
        
        <h3>Key Architectural Decisions:</h3>
        <table>
            <tr>
                <th>Decision</th>
                <th>Reasoning</th>
            </tr>
            <tr>
                <td>Serverless functions</td>
                <td>Auto-scaling, pay-per-use, no infrastructure management</td>
            </tr>
            <tr>
                <td>Dual storage (RDS + Data Lake)</td>
                <td>RDS for real-time queries, Parquet for historical analytics</td>
            </tr>
            <tr>
                <td>Event-driven triggers</td>
                <td>Automatic processing, no polling, minimal latency</td>
            </tr>
            <tr>
                <td>Retry queue with DLQ</td>
                <td>Resilience to transient failures, human review for persistent issues</td>
            </tr>
            <tr>
                <td>Quality scoring system</td>
                <td>Transparency in data reliability, enables confidence-based analytics</td>
            </tr>
            <tr>
                <td>Partitioned Parquet files</td>
                <td>Efficient time-range queries for analytics (e.g., "Q4 2024 consumption")</td>
            </tr>
        </table>
    </div>

    <div class="section">
        <h2>üìö Glossary</h2>
        <table>
            <tr>
                <th>Term</th>
                <th>Definition</th>
            </tr>
            <tr>
                <td><strong>ETL</strong></td>
                <td>Extract, Transform, Load - data integration process</td>
            </tr>
            <tr>
                <td><strong>Serverless</strong></td>
                <td>Cloud computing model where infrastructure scales automatically</td>
            </tr>
            <tr>
                <td><strong>RDS</strong></td>
                <td>Relational Database Service - managed SQL database</td>
            </tr>
            <tr>
                <td><strong>Parquet</strong></td>
                <td>Columnar storage format optimized for analytics</td>
            </tr>
            <tr>
                <td><strong>Data Lake</strong></td>
                <td>Centralized repository for storing structured and unstructured data at scale</td>
            </tr>
            <tr>
                <td><strong>Dead Letter Queue (DLQ)</strong></td>
                <td>Storage for messages that cannot be processed after max retries</td>
            </tr>
            <tr>
                <td><strong>Idempotency</strong></td>
                <td>Property where operation can be applied multiple times without changing result</td>
            </tr>
            <tr>
                <td><strong>Dark Data</strong></td>
                <td>Data collected and stored but not analyzed or utilized</td>
            </tr>
        </table>
    </div>

    <footer style="text-align: center; margin-top: 50px; padding-top: 20px; border-top: 2px solid #2c5f2d; color: #666;">
        <p><strong>GreenStream Energy - Design Thinking Task Solution</strong></p>
        <p>Serverless ETL Pipeline for Smart Meter Analytics</p>
    </footer>

</body>
</html>